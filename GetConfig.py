import configparser
import os
import json


FeatureSaveMode=["Mongodb","Sqlite","csv","json File"]

class GetConf(object):
    def __init__(self):
        self.getconfig()
        
    def getconfig(self):
        config=configparser.ConfigParser()
        path=os.path.split(os.path.realpath(__file__))[0]+"/MalwareMache.conf"
        config.read(path)
        self.confJson=dict(zip([_ for _ in config.sections()],[dict(zip([i for i in config.options(_)],[config.get(_,i) for i in config.options(_)])) for _ in config.sections()]))
        print json.dumps(self.confJson,sort_keys=True,indent=2)
        print "check your config ......   YES/NO"
        # a=raw_input()
        # if a=="NO":
        #     exit(0)
        self.MalwareMachePath=config.get("MalwareFilePath","malwarefp")
        GLCM_F=config.get("FeatureSet","GLCM_Feature")
        self.GLCM_F_List=GLCM_F[1:-1].split(",")
            # s=getattr(test(),_,lambda:"nothing")
        self.GLCMFeatureSaveDBMode=self.confJson["Output"]["glcmfeaturesave"]
        if not self.GLCMFeatureSaveDBMode or self.GLCMFeatureSaveDBMode not in FeatureSaveMode:
            raise ValueError("Your Save Mode can't find,Please read the README.md or MalwareMache.conf")
        self.N_GramFeatureSaveDBMode=config.get("Output","n_gram")
        if not self.N_GramFeatureSaveDBMode or self.N_GramFeatureSaveDBMode not in FeatureSaveMode:
            raise ValueError("Your Save Mode can't find,Please read the README.md or MalwareMache.conf")

if __name__ == "__main__":
    GetConf()